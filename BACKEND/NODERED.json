BACKEND


[{"id":"3b762a34.c489d6","type":"debug","name":"Message Transcription","active":true,"console":"false","complete":"transcription","x":650,"y":128,"z":"910b79ce.6ef488","wires":[]},{"id":"9467d625.6b9828","type":"alchemy-feature-extract","name":"Taxonomy","page-image":"","image-kw":"","feed":"","entity":true,"keyword":true,"title":"","author":"","taxonomy":false,"concept":"","relation":"","pub-date":"","doc-sentiment":true,"x":455,"y":322,"z":"910b79ce.6ef488","wires":[["d9ac4eb7.2653b","e3bda27c.1c426","f7e0dcb4.081f2"]]},{"id":"ca004d2a.35ffb","type":"debug","name":"Mail Text","active":false,"console":"false","complete":"payload","x":899,"y":388,"z":"910b79ce.6ef488","wires":[]},{"id":"d7dba3b0.28246","type":"e-mail","server":"smtp.gmail.com","port":"465","name":"niklaushirt@gmail.com","dname":"Send Mail","x":899,"y":322,"z":"910b79ce.6ef488","wires":[]},{"id":"d9ac4eb7.2653b","type":"function","name":"Create Mail Text","func":"\nmsg.topic='Thank you for contacting customer support';\nmsg.payload='Hi ' + msg.features.entity[0].text + ',\\r\\nThank you for contacting customer support.\\r\\nWe will be in touch shortly.\\r\\nRegards,\\r\\nYour Customer Support';\n\nreturn msg;","outputs":1,"noerr":0,"x":654,"y":322,"z":"910b79ce.6ef488","wires":[["ca004d2a.35ffb","cdd0b05e.322f5","d7dba3b0.28246"]]},{"id":"d1ae42d4.2e51c","type":"comment","name":"Analyze customer call","info":"","x":1079,"y":216,"z":"910b79ce.6ef488","wires":[]},{"id":"e4b1fd3a.1b4e","type":"comment","name":"Act on customer call","info":"","x":1079,"y":306,"z":"910b79ce.6ef488","wires":[]},{"id":"e3bda27c.1c426","type":"debug","name":"Taxonomy Values","active":true,"console":"false","complete":"features","x":665,"y":389,"z":"910b79ce.6ef488","wires":[]},{"id":"c820f3b4.37df1","type":"http in","name":"API - REQUEST","url":"/complaint","method":"get","swaggerDoc":"","x":202.5,"y":111,"z":"910b79ce.6ef488","wires":[["fc67907c.03987"]]},{"id":"fc67907c.03987","type":"function","name":"Get Text","func":"msg.payload=msg.req.query.text;\n\n\n\nreturn msg;","outputs":1,"noerr":0,"x":366.5,"y":200,"z":"910b79ce.6ef488","wires":[["9467d625.6b9828","3b762a34.c489d6"]]},{"id":"cdd0b05e.322f5","type":"http response","name":"API - REPLY","x":919,"y":459,"z":"910b79ce.6ef488","wires":[]},{"id":"8a0f85b7.75f078","type":"cloudant out","service":"nodeRedSandbox-cloudantNoSQLDB","cloudant":"","name":"Store in CRM","database":"complaints","payonly":false,"operation":"insert","x":905,"y":646,"z":"910b79ce.6ef488","wires":[]},{"id":"f7e0dcb4.081f2","type":"function","name":"Prepare CRM Format","func":"\n\nvar newMsg = { payload: msg.features };\n\nreturn newMsg;","outputs":1,"noerr":0,"x":660,"y":646,"z":"910b79ce.6ef488","wires":[["8a0f85b7.75f078"]]},{"id":"b697bc78.49684","type":"comment","name":"Store Call in CRM","info":"","x":1114,"y":646,"z":"910b79ce.6ef488","wires":[]}]


Dashboard
[{"id":"c0c7d0fa.3f383","type":"http in","name":"","url":"/dashboard","method":"get","swaggerDoc":"","x":266,"y":106,"z":"a5112b8c.5aeed8","wires":[["d13dc2f2.2ec24"]]},{"id":"727bd953.8d8428","type":"http response","name":"","x":739,"y":144,"z":"a5112b8c.5aeed8","wires":[]},{"id":"c1f3096c.3e0cf8","type":"cloudant in","service":"nodeRedSandbox-cloudantNoSQLDB","cloudant":"","name":"","database":"complaints","search":"_all_","design":"keyword.text","index":"urgent problem","x":484,"y":367,"z":"a5112b8c.5aeed8","wires":[["9c6ee104.63912","d0ad43c7.2f52c"]]},{"id":"faa5079d.055af8","type":"http in","name":"","url":"/getDashboardData","method":"get","swaggerDoc":"","x":249,"y":316,"z":"a5112b8c.5aeed8","wires":[["c1f3096c.3e0cf8"]]},{"id":"64174b6.f9be8b4","type":"http response","name":"","x":783,"y":400,"z":"a5112b8c.5aeed8","wires":[]},{"id":"bae342f1.451cc","type":"debug","name":"","active":true,"console":"false","complete":"false","x":845,"y":502,"z":"a5112b8c.5aeed8","wires":[]},{"id":"614246af.9ebdb8","type":"inject","name":"","topic":"","payload":"0e19c66632b539780dc2aa0c0bf5ffd0","payloadType":"string","repeat":"","crontab":"","once":false,"x":293,"y":515,"z":"a5112b8c.5aeed8","wires":[["c1f3096c.3e0cf8"]]},{"id":"9c6ee104.63912","type":"function","name":"","func":"var outputString=\"\"\n\nvar JSONString=JSON.stringify(msg.payload);\n\nvar globalArr = JSON.parse(JSONString);\n\n\nwhile (globalArr.length > 0) {\n   \n    var localString = globalArr.pop()\n   \n    outputString = outputString + localString.msgid + \"<br/>\";\n    \n    var localArr = JSON.parse(JSON.stringify(localString));\n    \n    while (localArr.length > 0) {\n        outputString = outputString + \"aaa:\";\n        //var entitiy = localArr.pop();\n        //outputString = outputString + JSON.stringify(entitiy) + \"aaa<br/>\";\n    }\n}\n\nmsg.payload=outputString\n\nreturn msg;","outputs":1,"noerr":0,"x":620,"y":489,"z":"a5112b8c.5aeed8","wires":[["bae342f1.451cc"]]},{"id":"d0ad43c7.2f52c","type":"function","name":"","func":"msg.payload=JSON.stringify(msg.payload);\n\n\nreturn msg;","outputs":1,"noerr":0,"x":651,"y":328,"z":"a5112b8c.5aeed8","wires":[["64174b6.f9be8b4"]]},{"id":"d13dc2f2.2ec24","type":"function","name":"","func":"msg.payload='<html> <head> <title>UrbanCode Deploy - Docker Demo</title> <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"> <link rel=\"stylesheet\" href=\"./public/stylesheets/style.css\"> </head> <body> <table> <tr> <td style=\"width:30%;\"><img src=\"./public/images/newapp-icon.png\"></td> <td> <h2>UrbanCode Deploy</h2> <h1>Docker Demo</h1> <p></p> <p></p> <p>Thanks for creating the <span class=\"blue\">NodeJS Application Backend</span>.</p> <p></p> <p>Testing DEMO API</p> <div id=\"idStatus\">Testing...</div><br> <div id=\"id0\"></div> <script> var xmlhttp = new XMLHttpRequest(); var url = \"http://localhost:3000/getDemo\"; xmlhttp.onreadystatechange = function () { if (xmlhttp.readyState == 4 && xmlhttp.status == 200) { var myArr = JSON.parse(xmlhttp.responseText); myFunctionN(myArr); document.getElementById(\"idStatus\").innerHTML = \"STATUS: OK\"; } else { document.getElementById(\"idStatus\").innerHTML = \"STATUS: ERROR\"; document.getElementById(\"id0\").innerHTML = \"Server not running\"; } } xmlhttp.open(\"GET\", url, true); xmlhttp.send(); function myFunction(arr) { document.getElementById(\"id01\").innerHTML = JSON.stringify(arr); } function myFunctionN(arr) { var out = \"\"; var i; var tempArr = arr.values; for (i = 0; i < tempArr.length; i++) { out += \"Name: \" + tempArr[i].name + \"<BR> eMail: \" + tempArr[i].email + \"</a><br><BR> \"; } document.getElementById(\"id0\").innerHTML = out; } </script> </td> </tr> </table> </body> </html>'\n\n\nreturn msg;","outputs":1,"noerr":0,"x":541,"y":133,"z":"a5112b8c.5aeed8","wires":[["727bd953.8d8428"]]}]



